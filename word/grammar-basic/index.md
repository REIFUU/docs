# koishi-plugin-word-core-grammar-basic

[词库引擎，基础语法扩展]

# 语法内容

## 添加物品到背包

### 语法格式：

|作用|语法格式|返回值|
|--|--|--|
|添加任意数量的物品到玩家背包|(+:物品名称:数量:用户id?)|操作的数量|
|添加随机数量的物品到玩家背包|(+:物品名称:数量~数量:用户id?)|操作的数量|
|添加以背包内原数量百分之x的物品到玩家背包|(+:物品名称:数量%:用户id?)|操作的数量|

当`用户id`为`that`时，代表为在触发时，被at的用户的id

`用户id`项可不填，此时此项前的`:`也不需要填写，这种情况下，为触发者自身添加物品

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|添加1条小鱼干到背包|(+:小鱼干:1)|1|
|添加1~100随机条小鱼干到背包|(+:小鱼干:1~100)|18|
|添加30%*背包内小鱼干的数量到背包（如果背包内有100条鱼）|(+:小鱼干:30%)|30|
|添加1条小鱼干到被at的人的背包|(+:小鱼干:1:that)|1|

***

## 从背包内减少物品

### 语法格式：

|作用|语法格式|返回值|
|--|--|--|
|从玩家背包减少任意数量的物品|(+:物品名称:数量:用户id?)|操作的数量|
|从玩家背包减少随机数量的物品|(+:物品名称:数量~数量:用户id?)|操作的数量|
|从玩家背包减少以背包内原数量百分之x的物品|(+:物品名称:数量%:用户id?)|操作的数量|

当`用户id`为`that`时，代表为在触发时，被at的用户的id

`用户id`项可不填，此时此项前的`:`也不需要填写，这种情况下，为触发者自身减少物品

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|减少1条小鱼干|(-:小鱼干:1)|1|
|减少1~100随机条小鱼干|(-:小鱼干:1~100)|18|
|减少30%背包内的小鱼干（如果背包内有100条鱼）|(-:小鱼干:30%)|30|
|被at的人减少1条小鱼干背包|(-:小鱼干:1:that)|1|

***

## 判断背包内物品数量是否满足要求

### 语法格式：

|作用|语法|
|--|--|
|当背包内物品的数量满足要求则显示`信息`，否则不显示|(?:物品名称:关系:数量:信息?:用户id?)|

`关系项`可以填写如下符号：

|大于|>|
|--|--|
|小于|<|
|等于|==|
|不等于|!=|
|大于等于|>=|
|小于等于|<=|

当`用户id`为 `that`时，代表为在触发时，被at的用户的id

`用户id`项可不填，此时此项前的`:`也不需要填写，这种情况下，为判断触发者自身的物品是否满足条件

`信息`项可不填或为空，当不填时此项前的`:`也不需要填写，这种情况下：

- 当物品数量满足要求时，继续执行本条语句
- 当物品数量不满足要求时，结束当前语句的执行重新从触发词的回答序列中随机挑选一句语句，重新解析直到无可执行的语句或语句成功输出时结束

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|如果自身小鱼干>10，则显示你的小鱼干满足要求！|(?:小鱼干:>:10:你的鱼干满足要求啦！)|你的鱼干满足要求啦！|
|如果自身小鱼干>10，则继续执行本条解析|(?:小鱼干:>:10)|<语句继续运行>|
|如果对方的小鱼干>10，则提示你的也满足啦|(?:小鱼干:>:10:你的鱼干满足要求啦！:that)|你的鱼干满足要求啦！|
|如果对方的小鱼干>10，则继续执行本条语句|(?:小鱼干:>:10::that)|<语句继续运行>|

***

## 输出背包内某物品数量

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|查看背包内小鱼干的数量|(#:物品名称:用户id?)|执行此语句时，背包内物品数量|

当`用户id`为 `that`时，代表为在触发时，被at的用户的id

`用户id`项可不填，此时此项前的:也不需要填写，这种情况下，为查询触发者自身物品数量

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|查看自己的小鱼干数量|(#:小鱼干)|114|
|查看被at者的小鱼干数量|(#:小鱼干:that)|514|

***

## 概率判断是否成功

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|有0~100的概率会输出`信息`项|(%:概率(0~100):消息?)|`信息`项|

`信息`项可不填或为空，当不填时此项前的:也不需要填写，这种情况下：

- 当物品数量满足要求时，继续执行本条语句
- 当物品数量不满足要求时，终止执行

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|30%的可能输出`赢啦`|(%:30:赢啦)|赢啦|

***

## 延迟发送

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|延迟发送一句话或者一段话|(&:时间:消息?)|`信息项`|

`时间`相为纯数字，单位是秒(s)

`信息`项可不填或为空，当不填时此项前的`:`也不需要填写，这种情况下：

- 延迟一定时间后发送此段回复词

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|延迟10秒发送`哼哼a`|(&:10:哼哼a)|哼哼a|

***

## 查看触发者的用户名

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|查看触发者的名字|(@this)|触发者用户名|

***

## 查看触发者的id

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|查看触发者的id|(#this)|触发者id|

***

## 查看被at人的用户名

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|查看被at的对方的用户名|(@that)|在触发句中被at的人的用户名|

***

## 查看被at者的id

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|查看被at的对方的id|(#that)|在触发句中被at的人的id|

## at一个人

### 语法格式&使用举例：

|作用|语法|返回值|
|--|--|--|
|at一个昵称|(@:对方昵称)|at一个人|
|at一个唯一标识|(#:对方id)|at一个人|

## CD语法

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|提示某段文本后，开始cd一定的秒数|(cd:事件名称:cd时间`(格式为s)`:信息?)|`信息项`|

`信息`项可不填或为空，当不填时此项前的:也不需要填写，这种情况下：

- 当第一次触发时，继续运行，创建一个名为`事件名称`的计时器
- 在计时器未记完时，结束当前语句的执行重新从触发词的回答序列中随机挑选一句语句，重新解析直到无可执行的语句或语句成功输出时结束
- 计时器记完后触发，视为第一条

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|发送你好后，10秒后触发才可以继续发送你好|(cd:你好cd:10:你好)|你好|

## 获取触发时所输入的数

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|获取触发句中`(数)`所代表的数字|(数:第几个输入的数)|触发句中`(数)`所代表的数字|

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|获取用户输入的第一个数|(数:1)|第一个数|

设定一个这样的问答：

问：你好(数)
答：(数:1)

此时，你发送：`你好12345`，机器人会回复：`12345`

## 四则运算

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|进行四则运算|(算:第一个数:算术符号:第二个数)|`第一个数`和`第二个数`进行四则运算|

`算数符号`有如下四种：`+`，`-`，`*`，`/`

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|运算3+1|(算:3:+:1)|4|

## 生成随机数

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|生成一个随机数|(~:下限:上限)|生成一个在`下限`和`上限`之间的一个随机数|

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|生成一个0~100的随机数|(~:0:100)|35|

## 获取时间

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|获取年/月/星期/日/时/分/秒|(time:格式选择)|年/月/星期/日/时/分/秒|

`格式选择项`有如下值：

- 获取年：1
- 获取月：2
- 获取星期：3
- 获取日：4
- 获取时：5
- 获取分：6
- 获取秒：7

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|获取现在是一周的星期几|(time:3)|2|

## 触发某触发词

### 语法格式：

|作用|语法|返回值|
|--|--|--|
|触发某个触发词|(调:`某触发词`)|此触发词的回复词运行的结果|

注意：
调用语句的时候，请不要在被调用的语句使用(换)

### 使用举例：

|作用|语法|返回值|
|--|--|--|
|触发“测试”这个触发词|(调:测试)|"测试"这个触发词的回复|

## 数字取整

### 语法格式&&使用举例：

|作用|语法|返回值|
|--|--|--|
|数值取整(向下取整)|(整:`数值`)|`数值`项的向下取整|
|取2.2这个数字为2|(整:2.2)|2|

## 分段回复

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|分为两个气泡发送|(换)|`多个气泡`|
|将aaa与bbb分为两段话|aaa(换)bbb|第一个气泡：aaa，第二个气泡：bbb|

## 弹出提示，获取输入

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|弹出气泡，等待用户输入|(wi:输入的值的备注?)|`输入提示`|
|需要输入数量|你输入了：(wi:数量)|请输入`数量`参数的值：|
|获取一个输入|你输入了：(wi)|请输入：|

备注：
`(wi:输入的值的备注)`中`:输入的值的备注`可不写，此时，弹出的提示消息会不包含 `xxx参数的值`字样。

当输入超时时（5秒内未输入），输入的数值则为空

(ps:在想要不要加个参数项，可以进行正则校验输入的文字格式)

##  物品排行榜

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|获取某物品的数量排行榜|(排行榜:物品名称)|某物品的排行榜|

##  权限验证

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|判断触发者是否拥有某权限|(p:权限名:消息?)|`消息`项|

备注：
`消息`项可不写，此时，前面的`:`也不需要写，此时，若权限验证失败时，会跳转到当前的触发句的未解析的其他回复中，若无其他回复时，则会结束运行。

## 音频点播

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|发送一段音频|(歌曲:歌曲url直链)|一段音乐~|

## 视频点播

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|发送一段视频|(视频:视频url直链)|一段音乐~|

## 禁言

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|禁言触发者|(禁言:时间)|禁言触发者|
|禁言指定人员|(禁言:时间:用户id)|禁言指定的人|
|禁言时附带理由|(禁言:时间:用户id:理由)|禁言指定的人并且附带理由|

备注： 时间单位是s，为0时则解禁

## 踢

### 语法格式&&使用举例

|作用|语法|返回值|
|--|--|--|
|踢掉触发者|(踢)|触发者被踢了|
|踢掉指定的人|(踢:用户id)|指定的人被踢了|
|永久踢出|(踢:用户id,1)|指定的人被永久踢出了|
